doctype html
html
  head
    title title
  body
    h1 title

    form()
      div
        label(for="nome") Nome:
        input(type="text", name="nome", id="nome", required)
      div
        label(for="email") Email:
        input(type="email", name="email", id="email", required)
      div
        label(for="senha") Senha:
        input(type="password", name="senha", id="senha", required)
      div
        label(for="senha1") Confirmar Senha:
        input(type="password", name="senha1", id="senha1", required)
      div 
        p(id="message")
      div
        button(type="button", id="btnCadastrar") Cadastrar
      div 
        a(href="/login") Login 

    script.
      document.addEventListener('DOMContentLoaded', () => {
        const btnCadastrar = document.getElementById('btnCadastrar');
        const message = document.getElementById('message');

        btnCadastrar.addEventListener('click', async () => {
          const nome = document.getElementById('nome').value;
          const email = document.getElementById('email').value;
          const senha = document.getElementById('senha').value;
          const senha1 = document.getElementById('senha1').value;

          if (senha !== senha1) {
            message.textContent = 'As senhas não conferem';
            return;
          } else {
            message.textContent = '';
          }

          try {
            const response = await fetch('/cliente/registrar', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify({ nome, email, senha })
            });

            const data = await response.json();

            if (!response.ok) {
              alert(data.erro || 'Erro no cadastro');
              return;
            }

            alert('Cadastro realizado com sucesso!');
  
          } catch (err) {
            console.error(err);
            alert('Erro de conexão com o servidor');
          }
        });
      });