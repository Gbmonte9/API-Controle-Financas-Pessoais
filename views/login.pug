doctype html
html
  head
    title Login
  body
    h1 Login

    form
      div
        label(for="email") Email:
        input(type="email", name="email", id="email", required)
      div
        label(for="senha") Senha:
        input(type="password", name="senha", id="senha", required)
      div
        button(type="button", id="btnEntrar") Entrar
      div 
        a(href="/registrar") Cadastrar
      div 
        p(id="message")

    script.
      document.addEventListener('DOMContentLoaded', () => {
        const btnEntrar = document.getElementById('btnEntrar');
        const message = document.getElementById('message');

        btnEntrar.addEventListener('click', async (event) => {
          event.preventDefault();

          const email = document.getElementById('email').value;
          const senha = document.getElementById('senha').value;

          try {
            const response = await fetch('/cliente/login', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify({ email, senha })
            });

            const data = await response.json();

            if (!response.ok) {
              alert(data.erro || 'Erro ao fazer login');
              return;
            }

            localStorage.setItem('token', data.token);
            localStorage.setItem('email', email);
            localStorage.setItem('id', data.id);

            alert('Login realizado com sucesso!');
            window.location.href = '/dashboard'; 

          } catch (err) {
            console.error(err);
            alert('Erro de conex√£o com o servidor');
          }
        });
      });