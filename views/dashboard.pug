html
  head
    title Dashboard
  body
    h1 Bem-vindo à Dashboard

    p(id="dados-cliente") Carregando dados...

    section#resumo-financeiro
      h2 Resumo Financeiro
      ul
        li Saldo Atual: R$ 2.500,00
        li Total de Receitas: R$ 5.000,00
        li Total de Despesas: R$ 2.500,00

    nav
      ul
        li: a(href="/perfil") Perfil
        li: a(href="/transacoes") Transações
        li: a(href="/transacoes/nova") Fazer Transações
        li: a(href="/relatorios") Relatorios
        li: a(href="/") Sair

    script.
        document.addEventListener('DOMContentLoaded', async () => {
            const token = localStorage.getItem('token');
            const email = localStorage.getItem('email');
            console.log("Token: ", token);
            console.log("Email: ", email);

            if (!token) {
                alert('Você precisa estar logado.');
                window.location.href = '/';
                return;
            }

            try {
                const response = await fetch(`cliente/dados/email/${email}`, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}`
                }
                });

                const data = await response.json();

                if (!response.ok) {
                alert(data.erro || 'Erro ao buscar dados');
                return;
                }

                console.log('Cliente logado:', data);

                const cliente = Array.isArray(data) ? data[0] : data;

                const pDadosCliente = document.getElementById('dados-cliente');
                pDadosCliente.textContent = `Bem-vindo, ${cliente.nome}`;

            } catch (err) {
                console.error(err);
                alert('Erro de conexão com o servidor');
            }
        });